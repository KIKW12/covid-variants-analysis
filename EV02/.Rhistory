table.paint(MatrizDG, cleg = 0, clabel.row = 0.5, clabel.col = 0.5)
tre <- nj(D)
plot(tre, cex = 0.6)
title("Árbol de tipo NJ")
h_cluster <- hclust(D, method = "average", members = NULL)
plot(h_cluster, cex = 0.6)
myBoots <- boot.phylo(tre, dna, function(e) root(nj(impute_mean(dist.dna(e, model = "JC"))), 1))
myPal <- colorRampPalette(c("red", "yellow", "green", "blue"))
plot(tre, edge.width = 1, cex = 0.7)
title("NJ tree + bootstrap values")
tiplabels(frame = "none", pch = 20, col = transp(num2col(annot$year, col.pal = myPal), 0.7), cex = 3, fg = "transparent")
temp <- pretty(1993:2008, 5)
legend("bottomright", fill = transp(num2col(temp, col.pal = myPal), 0.7), leg = temp, ncol = 2, cex = 0.6)
nodelabels(myBoots, cex = 0.6)
library(ade4)
library(ape)
library(adegenet)
library(Biostrings)
library(ggplot2)
library(stringr)
variantes <- c("Civet.fasta", "HCoV-229E.fna", "HCoV-HKU1.fna", "HCoV-NL63.fna", "HCoV-OC43.fna", "MERS-CoV.fna", "RaTG13.fasta", "RpYN06.fasta", "SARS-CoV.fna", "SARS-CoV-2.fna")
nombre_variantes <- c("Civet SARS-CoV", "Human Coronavirus 229E", "Human Coronavirus HKU1", "Human Coronavirus NL63", "Human Coronavirus OC43", "Middle East Respiratory Syndrome", "Bat Coronavirus RaTG13", "Betacoronavirus RpYN06", "Severe Acute Respirstory Syndrome", "Severe Acute Respirstory Syndrome 2")
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
dna <- fasta2DNAbin(file="usflu.fasta")
dna
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
ggplot(datos_combinados, aes(x = Base, y = Count, fill = Base)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Variante, scales = "free_y") +
labs(title = "Bases de ADN en diferentes variantes",
x = "Base", y = "Count") +
theme_minimal()
annot <- read.csv("usflu.annot.csv", header=TRUE, row.names=1)
D <- dist.dna(dna, model = "JC")
length(D)
D[is.na(D)] <- 0
MatrizDG <- as.data.frame(as.matrix(D))
table.paint(MatrizDG, cleg = 0, clabel.row = 0.5, clabel.col = 0.5)
tre <- njs(D)
plot(tre, cex = 0.6)
title("Árbol de tipo NJ")
h_cluster <- hclust(D, method = "average", members = NULL)
plot(h_cluster, cex = 0.6)
myBoots <- boot.phylo(tre, dna, function(e) root(njs((dist.dna(e, model = "JC"))), 1))
myPal <- colorRampPalette(c("red", "yellow", "green", "blue"))
plot(tre, edge.width = 1, cex = 0.7)
title("NJ tree + bootstrap values")
tiplabels(frame = "none", pch = 20, col = transp(num2col(annot$year, col.pal = myPal), 0.7), cex = 3, fg = "transparent")
temp <- pretty(1993:2008, 5)
legend("bottomright", fill = transp(num2col(temp, col.pal = myPal), 0.7), leg = temp, ncol = 2, cex = 0.6)
nodelabels(myBoots, cex = 0.6)
?dist.dna
library(ade4)
library(ape)
library(adegenet)
library(Biostrings)
library(ggplot2)
library(stringr)
variantes <- c("Civet.fasta", "HCoV-229E.fna", "HCoV-HKU1.fna", "HCoV-NL63.fna", "HCoV-OC43.fna", "MERS-CoV.fna", "RaTG13.fasta", "RpYN06.fasta", "SARS-CoV.fna", "SARS-CoV-2.fna")
nombre_variantes <- c("Civet SARS-CoV", "Human Coronavirus 229E", "Human Coronavirus HKU1", "Human Coronavirus NL63", "Human Coronavirus OC43", "Middle East Respiratory Syndrome", "Bat Coronavirus RaTG13", "Betacoronavirus RpYN06", "Severe Acute Respirstory Syndrome", "Severe Acute Respirstory Syndrome 2")
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
dna <- fasta2DNAbin(file="usflu.fasta")
dna
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
ggplot(datos_combinados, aes(x = Base, y = Count, fill = Base)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Variante, scales = "free_y") +
labs(title = "Bases de ADN en diferentes variantes",
x = "Base", y = "Count") +
theme_minimal()
annot <- read.csv("usflu.annot.csv", header=TRUE, row.names=1)
D <- dist.dna(dna, model = "JC69")
length(D)
D[is.na(D)] <- 0
MatrizDG <- as.data.frame(as.matrix(D))
table.paint(MatrizDG, cleg = 0, clabel.row = 0.5, clabel.col = 0.5)
tre <- njs(D)
plot(tre, cex = 0.6)
title("Árbol de tipo NJ")
h_cluster <- hclust(D, method = "average", members = NULL)
plot(h_cluster, cex = 0.6)
myBoots <- boot.phylo(tre, dna, function(e) root(njs((dist.dna(e, model = "JC69"))), 1))
myPal <- colorRampPalette(c("red", "yellow", "green", "blue"))
plot(tre, edge.width = 1, cex = 0.7)
title("NJ tree + bootstrap values")
tiplabels(frame = "none", pch = 20, col = transp(num2col(annot$year, col.pal = myPal), 0.7), cex = 3, fg = "transparent")
temp <- pretty(1993:2008, 5)
legend("bottomright", fill = transp(num2col(temp, col.pal = myPal), 0.7), leg = temp, ncol = 2, cex = 0.6)
nodelabels(myBoots, cex = 0.6)
library(ade4)
library(ape)
library(adegenet)
library(Biostrings)
library(ggplot2)
library(stringr)
variantes <- c("Civet.fasta", "HCoV-229E.fna", "HCoV-HKU1.fna", "HCoV-NL63.fna", "HCoV-OC43.fna", "MERS-CoV.fna", "RaTG13.fasta", "RpYN06.fasta", "SARS-CoV.fna", "SARS-CoV-2.fna")
nombre_variantes <- c("Civet SARS-CoV", "Human Coronavirus 229E", "Human Coronavirus HKU1", "Human Coronavirus NL63", "Human Coronavirus OC43", "Middle East Respiratory Syndrome", "Bat Coronavirus RaTG13", "Betacoronavirus RpYN06", "Severe Acute Respirstory Syndrome", "Severe Acute Respirstory Syndrome 2")
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
dna <- fasta2DNAbin(file="usflu.fasta")
dna
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
ggplot(datos_combinados, aes(x = Base, y = Count, fill = Base)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Variante, scales = "free_y") +
labs(title = "Bases de ADN en diferentes variantes",
x = "Base", y = "Count") +
theme_minimal()
annot <- read.csv("usflu.annot.csv", header=TRUE, row.names=1)
D <- dist.dna(dna, model = "JC69")
length(D)
D[is.na(D)] <- 0
MatrizDG <- as.data.frame(as.matrix(D))
table.paint(MatrizDG, cleg = 0, clabel.row = 0.5, clabel.col = 0.5)
tre <- njs(D)
plot(tre, cex = 0.6)
title("Árbol de tipo Njs")
h_cluster <- hclust(D, method = "average", members = NULL)
plot(h_cluster, cex = 0.6)
myBoots <- boot.phylo(tre, dna, function(e) root(njs((dist.dna(e, model = "JC69"))), 1))
library(ade4)
library(ape)
library(adegenet)
library(Biostrings)
library(ggplot2)
library(stringr)
variantes <- c("Civet.fasta", "HCoV-229E.fna", "HCoV-HKU1.fna", "HCoV-NL63.fna", "HCoV-OC43.fna", "MERS-CoV.fna", "RaTG13.fasta", "RpYN06.fasta", "SARS-CoV.fna", "SARS-CoV-2.fna")
nombre_variantes <- c("Civet SARS-CoV", "Human Coronavirus 229E", "Human Coronavirus HKU1", "Human Coronavirus NL63", "Human Coronavirus OC43", "Middle East Respiratory Syndrome", "Bat Coronavirus RaTG13", "Betacoronavirus RpYN06", "Severe Acute Respirstory Syndrome", "Severe Acute Respirstory Syndrome 2")
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
dna <- fasta2DNAbin(file="usflu.fasta")
dna
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
ggplot(datos_combinados, aes(x = Base, y = Count, fill = Base)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Variante, scales = "free_y") +
labs(title = "Bases de ADN en diferentes variantes",
x = "Base", y = "Count") +
theme_minimal()
annot <- read.csv("usflu.annot.csv", header=TRUE, row.names=1)
D <- dist.dna(dna, model = "JC69")
length(D)
D[is.na(D)] <- 0
MatrizDG <- as.data.frame(as.matrix(D))
table.paint(MatrizDG, cleg = 0, clabel.row = 0.5, clabel.col = 0.5)
tre <- njs(D)
plot(tre, cex = 0.6)
title("Árbol de tipo NJ")
h_cluster <- hclust(D, method = "average", members = NULL)
plot(h_cluster, cex = 0.6)
myBoots <- boot.phylo(tre, dna, function(e) root(njs((dist.dna(e, model = "JC69"))), 1))
myPal <- colorRampPalette(c("red", "yellow", "green", "blue"))
plot(tre, edge.width = 1, cex = 0.7)
title("NJ tree + bootstrap values")
tiplabels(frame = "none", pch = 20, col = transp(num2col(annot$year, col.pal = myPal), 0.7), cex = 3, fg = "transparent")
temp <- pretty(1993:2008, 5)
legend("bottomright", fill = transp(num2col(temp, col.pal = myPal), 0.7), leg = temp, ncol = 2, cex = 0.6)
nodelabels(myBoots, cex = 0.6)
library(ade4)
library(ape)
library(adegenet)
library(Biostrings)
library(ggplot2)
library(stringr)
variantes <- c("Civet.fasta", "HCoV-229E.fna", "HCoV-HKU1.fna", "HCoV-NL63.fna", "HCoV-OC43.fna", "MERS-CoV.fna", "RaTG13.fasta", "RpYN06.fasta", "SARS-CoV.fna", "SARS-CoV-2.fna")
nombre_variantes <- c("Civet SARS-CoV", "Human Coronavirus 229E", "Human Coronavirus HKU1", "Human Coronavirus NL63", "Human Coronavirus OC43", "Middle East Respiratory Syndrome", "Bat Coronavirus RaTG13", "Betacoronavirus RpYN06", "Severe Acute Respirstory Syndrome", "Severe Acute Respirstory Syndrome 2")
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
dna <- fasta2DNAbin(file="usflu.fasta")
dna
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
ggplot(datos_combinados, aes(x = Base, y = Count, fill = Base)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Variante, scales = "free_y") +
labs(title = "Bases de ADN en diferentes variantes",
x = "Base", y = "Count") +
theme_minimal()
annot <- read.csv("usflu.annot.csv", header=TRUE, row.names=1)
D <- dist.dna(dna, model = "JC69")
length(D)
D[is.na(D)] <- 0
MatrizDG <- as.data.frame(as.matrix(D))
table.paint(MatrizDG, cleg = 0, clabel.row = 0.5, clabel.col = 0.5)
tre <- njs(D)
plot(tre, cex = 0.6)
title("Árbol de tipo NJS")
h_cluster <- hclust(D, method = "average", members = NULL)
plot(h_cluster, cex = 0.6)
myBoots <- boot.phylo(tre, dna, function(e) root(njs((dist.dna(e, model = "JC69"))), 1))
library(ade4)
library(ape)
library(adegenet)
library(Biostrings)
library(ggplot2)
library(stringr)
variantes <- c("Civet.fasta", "HCoV-229E.fna", "HCoV-HKU1.fna", "HCoV-NL63.fna", "HCoV-OC43.fna", "MERS-CoV.fna", "RaTG13.fasta", "RpYN06.fasta", "SARS-CoV.fna", "SARS-CoV-2.fna")
nombre_variantes <- c("Civet SARS-CoV", "Human Coronavirus 229E", "Human Coronavirus HKU1", "Human Coronavirus NL63", "Human Coronavirus OC43", "Middle East Respiratory Syndrome", "Bat Coronavirus RaTG13", "Betacoronavirus RpYN06", "Severe Acute Respirstory Syndrome", "Severe Acute Respirstory Syndrome 2")
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
dna <- fasta2DNAbin(file="usflu.fasta")
dna
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
ggplot(datos_combinados, aes(x = Base, y = Count, fill = Base)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Variante, scales = "free_y") +
labs(title = "Bases de ADN en diferentes variantes",
x = "Base", y = "Count") +
theme_minimal()
annot <- read.csv("usflu.annot.csv", header=TRUE, row.names=1)
D <- dist.dna(dna, model = "JC69")
length(D)
D[is.na(D)] <- 0
MatrizDG <- as.data.frame(as.matrix(D))
table.paint(MatrizDG, cleg = 0, clabel.row = 0.5, clabel.col = 0.5)
tre <- njs(D)
plot(tre, cex = 0.6)
title("Árbol de tipo NJ")
h_cluster <- hclust(D, method = "average", members = NULL)
plot(h_cluster, cex = 0.6)
myBoots <- boot.phylo(tre, dna, function(e) root(njs((dist.dna(e, model = "JC69"))), 1))
myPal <- colorRampPalette(c("red", "yellow", "green", "blue"))
plot(tre, edge.width = 1, cex = 0.7)
title("NJ tree + bootstrap values")
tiplabels(frame = "none", pch = 20, col = transp(num2col(annot$year, col.pal = myPal), 0.7), cex = 3, fg = "transparent")
temp <- pretty(1993:2008, 5)
legend("bottomright", fill = transp(num2col(temp, col.pal = myPal), 0.7), leg = temp, ncol = 2, cex = 0.6)
nodelabels(myBoots, cex = 0.6)
library(ade4)
library(ape)
library(adegenet)
library(Biostrings)
library(ggplot2)
library(stringr)
variantes <- c("Civet.fasta", "HCoV-229E.fna", "HCoV-HKU1.fna", "HCoV-NL63.fna", "HCoV-OC43.fna", "MERS-CoV.fna", "RaTG13.fasta", "RpYN06.fasta", "SARS-CoV.fna", "SARS-CoV-2.fna")
nombre_variantes <- c("Civet SARS-CoV", "Human Coronavirus 229E", "Human Coronavirus HKU1", "Human Coronavirus NL63", "Human Coronavirus OC43", "Middle East Respiratory Syndrome", "Bat Coronavirus RaTG13", "Betacoronavirus RpYN06", "Severe Acute Respirstory Syndrome", "Severe Acute Respirstory Syndrome 2")
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
dna <- fasta2DNAbin(file="usflu.fasta")
dna
contar_bases <- function(ADN) {
a_count <- str_count(ADN, pattern = "A")
t_count <- str_count(ADN, pattern = "T")
g_count <- str_count(ADN, pattern = "G")
c_count <- str_count(ADN, pattern = "C")
n_count <- str_count(ADN, pattern = "N")
data.frame(Base = c("A", "T", "G", "C", "N"), Count = c(a_count, t_count, g_count, c_count, n_count))
}
datos <- list()
nombres <- list()
for (i in 1:length(variantes)) {
ADN_set <- readDNAStringSet(variantes[i])
adn <- toString(ADN_set)
base_counts <- contar_bases(adn)
datos[[i]] <- base_counts
nombres[[i]] <- nombre_variantes[i]
}
datos_combinados <- do.call(rbind, datos)
datos_combinados$Variante <- rep(nombre_variantes, each = 5)
ggplot(datos_combinados, aes(x = Base, y = Count, fill = Base)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Variante, scales = "free_y") +
labs(title = "Bases de ADN en diferentes variantes",
x = "Base", y = "Count") +
theme_minimal()
annot <- read.csv("usflu.annot.csv", header=TRUE, row.names=1)
D <- dist.dna(dna, model = "JC69")
length(D)
D[is.na(D)] <- 0
MatrizDG <- as.data.frame(as.matrix(D))
table.paint(MatrizDG, cleg = 0, clabel.row = 0.5, clabel.col = 0.5)
tre <- njs(D)
plot(tre, cex = 0.6)
title("Árbol de tipo NJ")
h_cluster <- hclust(D, method = "average", members = NULL)
plot(h_cluster, cex = 0.6)
myBoots <- boot.phylo(tre, dna, function(e) root(njs((dist.dna(e, model = "JC69"))), 1))
myPal <- colorRampPalette(c("red", "yellow", "green", "blue"))
plot(tre, edge.width = 1, cex = 0.7)
title("NJ tree + bootstrap values")
tiplabels(frame = "none", pch = 20, col = transp(num2col(annot$year, col.pal = myPal), 0.7), cex = 3, fg = "transparent")
temp <- pretty(1993:2008, 5)
legend("bottomright", fill = transp(num2col(temp, col.pal = myPal), 0.7), leg = temp, ncol = 2, cex = 0.6)
nodelabels(myBoots, cex = 0.6)
